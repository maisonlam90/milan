2025-11-08T15:57:43.366515Z  INFO milan::infra::wasm_loader: ‚úÖ Loaded module: school
2025-11-08T15:57:43.366696Z  INFO milan: ‚úÖ Loaded 1 modules ngo√†i binary t·ª´ "../modules"
2025-11-08T15:57:43.368014Z  INFO milan::api::external_modules: ‚úÖ Registered routes cho module: school
2025-11-08T15:57:46.317096Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:00:46.663350Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:00:47.017243Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=0 rows_returned=0 elapsed=345.713456ms elapsed_secs=0.345713456
2025-11-08T16:00:47.018665Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:00:47.396360Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=0 rows_returned=0 elapsed=327.228189ms elapsed_secs=0.327228189
2025-11-08T16:01:07.564293Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:01:13.335152Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:02:28.243283Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:02:28.373722Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=126.2455ms elapsed_secs=0.1262455
2025-11-08T16:02:28.376915Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:02:28.452503Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=71.858411ms elapsed_secs=0.071858411
2025-11-08T16:02:32.403309Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list?is_company=true&limit=200
2025-11-08T16:02:32.416357Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=3 rows_returned=3 elapsed=9.217721ms elapsed_secs=0.009217721
2025-11-08T16:02:32.417744Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list?is_company=true&limit=200
2025-11-08T16:02:32.428118Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=3 rows_returned=3 elapsed=6.096159ms elapsed_secs=0.006096159
2025-11-08T16:02:32.446985Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /c0777777-7777-7777-7777-777777777777
2025-11-08T16:02:32.463070Z DEBUG sqlx::query: summary="SELECT id, is_company, parent_id, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  is_company,\n  parent_id,\n  name,\n  display_name,\n  email,\n  phone,\n  mobile,\n  website,\n  street,\n  street2,\n  city,\n  state,\n  zip,\n  country_code,\n  national_id AS \"national_id?: String\",  -- üëà TH√äM\n  notes,\n  NULLIF(tags_cached, '') AS \"tags_cached?: String\",\n  created_at,\n  updated_at\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND id = $2\n" rows_affected=0 rows_returned=1 elapsed=12.21152ms elapsed_secs=0.01221152
2025-11-08T16:02:32.466193Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /c0777777-7777-7777-7777-777777777777
2025-11-08T16:02:32.484112Z DEBUG sqlx::query: summary="SELECT id, is_company, parent_id, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  is_company,\n  parent_id,\n  name,\n  display_name,\n  email,\n  phone,\n  mobile,\n  website,\n  street,\n  street2,\n  city,\n  state,\n  zip,\n  country_code,\n  national_id AS \"national_id?: String\",  -- üëà TH√äM\n  notes,\n  NULLIF(tags_cached, '') AS \"tags_cached?: String\",\n  created_at,\n  updated_at\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND id = $2\n" rows_affected=0 rows_returned=1 elapsed=11.306333ms elapsed_secs=0.011306333
2025-11-08T16:03:10.147014Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:03:14.050935Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:03:36.056092Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:03:48.967061Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:03:49.179453Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND type = 'sale'\n  AND active = TRUE\nORDER BY\n  sequence,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=0 elapsed=167.837668ms elapsed_secs=0.167837668
2025-11-08T16:03:49.274982Z DEBUG sqlx::query: summary="INSERT INTO account_journal ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_journal (\n    tenant_id,\n    id,\n    name,\n    code,\n    type,\n    active,\n    created_by\n  )\nVALUES\n  (\n    $1,\n    $2,\n    'Sales',\n    'SALE',\n    'sale',\n    TRUE,\n    $3\n  ) ON CONFLICT (tenant_id, code) DO NOTHING\n" rows_affected=1 rows_returned=0 elapsed=93.253848ms elapsed_secs=0.093253848
2025-11-08T16:03:49.284318Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND code = 'SALE'\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=7.877812ms elapsed_secs=0.007877812
2025-11-08T16:03:49.396251Z DEBUG sqlx::query: summary="INSERT INTO account_move ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move (\n    tenant_id,\n    id,\n    name,\n    date,\n    journal_id,\n    currency_id,\n    move_type,\n    state,\n    partner_id,\n    commercial_partner_id,\n    partner_shipping_id,\n    partner_bank_id,\n    invoice_date,\n    invoice_date_due,\n    invoice_origin,\n    invoice_payment_term_id,\n    invoice_user_id,\n    invoice_incoterm_id,\n    fiscal_position_id,\n    narration,\n    amount_untaxed,\n    amount_tax,\n    amount_total,\n    amount_residual,\n    amount_untaxed_signed,\n    amount_tax_signed,\n    amount_total_signed,\n    amount_residual_signed,\n    created_by,\n    assignee_id,\n    shared_with\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    'out_invoice',\n    'draft',\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    $16,\n    $17,\n    $18,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    $19,\n    $20,\n    $21\n  )\n" rows_affected=0 rows_returned=0 elapsed=105.479687ms elapsed_secs=0.105479687
2025-11-08T16:04:40.600366Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:04:40.665023Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND type = 'sale'\n  AND active = TRUE\nORDER BY\n  sequence,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=62.043746ms elapsed_secs=0.062043746
2025-11-08T16:04:40.717145Z DEBUG sqlx::query: summary="INSERT INTO account_move ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move (\n    tenant_id,\n    id,\n    name,\n    date,\n    journal_id,\n    currency_id,\n    move_type,\n    state,\n    partner_id,\n    commercial_partner_id,\n    partner_shipping_id,\n    partner_bank_id,\n    invoice_date,\n    invoice_date_due,\n    invoice_origin,\n    invoice_payment_term_id,\n    invoice_user_id,\n    invoice_incoterm_id,\n    fiscal_position_id,\n    narration,\n    amount_untaxed,\n    amount_tax,\n    amount_total,\n    amount_residual,\n    amount_untaxed_signed,\n    amount_tax_signed,\n    amount_total_signed,\n    amount_residual_signed,\n    created_by,\n    assignee_id,\n    shared_with\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    'out_invoice',\n    'draft',\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    $16,\n    $17,\n    $18,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    $19,\n    $20,\n    $21\n  )\n" rows_affected=1 rows_returned=0 elapsed=45.37456ms elapsed_secs=0.04537456
2025-11-08T16:04:40.795849Z DEBUG sqlx::query: summary="SELECT id FROM account_account ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_account\nWHERE\n  tenant_id = $1\n  AND account_type = 'income'\n  AND deprecated = FALSE\nORDER BY\n  code,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=0 elapsed=75.609387ms elapsed_secs=0.075609387
2025-11-08T16:04:40.865389Z DEBUG sqlx::query: summary="INSERT INTO account_account ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_account (\n    tenant_id,\n    id,\n    code,\n    name,\n    account_type,\n    internal_group,\n    created_by\n  )\nVALUES\n  (\n    $1,\n    $2,\n    '400000',\n    'Product Sales',\n    'income',\n    'income',\n    $3\n  ) ON CONFLICT (tenant_id, code) DO NOTHING\n" rows_affected=1 rows_returned=0 elapsed=67.076014ms elapsed_secs=0.067076014
2025-11-08T16:04:40.872836Z DEBUG sqlx::query: summary="SELECT id FROM account_account ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_account\nWHERE\n  tenant_id = $1\n  AND code = '400000'\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=6.02957ms elapsed_secs=0.00602957
2025-11-08T16:04:41.005126Z DEBUG sqlx::query: summary="INSERT INTO account_move_line ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move_line (\n    tenant_id,\n    id,\n    move_id,\n    currency_id,\n    product_id,\n    product_uom_id,\n    quantity,\n    price_unit,\n    discount,\n    name,\n    sequence,\n    display_type,\n    account_id,\n    price_subtotal,\n    price_total,\n    debit,\n    credit,\n    balance,\n    amount_currency,\n    exclude_from_invoice_tab\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    0,\n    0,\n    0,\n    0,\n    false\n  )\n" rows_affected=1 rows_returned=0 elapsed=126.095841ms elapsed_secs=0.126095841
2025-11-08T16:04:41.101760Z DEBUG sqlx::query: summary="SELECT COALESCE(SUM(price_subtotal), 0)::numeric as ‚Ä¶" db.statement="\n\nSELECT\n  COALESCE(SUM(price_subtotal), 0) :: numeric as amount_untaxed,\n  COALESCE(SUM(price_total - price_subtotal), 0) :: numeric as amount_tax,\n  COALESCE(SUM(price_total), 0) :: numeric as amount_total\nFROM\n  account_move_line\nWHERE\n  tenant_id = $1\n  AND move_id = $2\n  AND (\n    display_type IS NULL\n    OR display_type NOT IN ('line_section', 'line_subsection', 'line_note')\n  )\n" rows_affected=0 rows_returned=1 elapsed=90.243864ms elapsed_secs=0.090243864
2025-11-08T16:04:41.137025Z DEBUG sqlx::query: summary="UPDATE account_move SET amount_untaxed ‚Ä¶" db.statement="\n\nUPDATE\n  account_move\nSET\n  amount_untaxed = $1,\n  amount_tax = $2,\n  amount_total = $3,\n  amount_residual = $3,\n  amount_untaxed_signed = $1,\n  amount_tax_signed = $2,\n  amount_total_signed = $3,\n  amount_residual_signed = $3,\n  updated_at = now()\nWHERE\n  tenant_id = $4\n  AND id = $5\n" rows_affected=1 rows_returned=0 elapsed=32.404836ms elapsed_secs=0.032404836
2025-11-08T16:04:41.401081Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:04:41.416056Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=1 rows_returned=1 elapsed=5.720572ms elapsed_secs=0.005720572
2025-11-08T16:04:41.428571Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:04:41.446160Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=1 rows_returned=1 elapsed=6.76139ms elapsed_secs=0.00676139
2025-11-08T16:04:52.432538Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:04:52.571925Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=1 rows_returned=1 elapsed=132.864778ms elapsed_secs=0.132864778
2025-11-08T16:04:52.574512Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:04:52.585524Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=1 rows_returned=1 elapsed=4.29256ms elapsed_secs=0.00429256
2025-11-08T16:05:25.901828Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:05:25.964546Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=1 rows_returned=1 elapsed=53.975892ms elapsed_secs=0.053975892
2025-11-08T16:05:25.966712Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:05:25.985588Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=1 rows_returned=1 elapsed=11.497219ms elapsed_secs=0.011497219
2025-11-08T16:05:41.320684Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:05:41.350361Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND type = 'sale'\n  AND active = TRUE\nORDER BY\n  sequence,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=26.687863ms elapsed_secs=0.026687863
2025-11-08T16:05:41.382853Z DEBUG sqlx::query: summary="INSERT INTO account_move ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move (\n    tenant_id,\n    id,\n    name,\n    date,\n    journal_id,\n    currency_id,\n    move_type,\n    state,\n    partner_id,\n    commercial_partner_id,\n    partner_shipping_id,\n    partner_bank_id,\n    invoice_date,\n    invoice_date_due,\n    invoice_origin,\n    invoice_payment_term_id,\n    invoice_user_id,\n    invoice_incoterm_id,\n    fiscal_position_id,\n    narration,\n    amount_untaxed,\n    amount_tax,\n    amount_total,\n    amount_residual,\n    amount_untaxed_signed,\n    amount_tax_signed,\n    amount_total_signed,\n    amount_residual_signed,\n    created_by,\n    assignee_id,\n    shared_with\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    'out_invoice',\n    'draft',\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    $16,\n    $17,\n    $18,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    $19,\n    $20,\n    $21\n  )\n" rows_affected=0 rows_returned=0 elapsed=25.841671ms elapsed_secs=0.025841671
2025-11-08T16:05:46.168779Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:05:46.188422Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND type = 'sale'\n  AND active = TRUE\nORDER BY\n  sequence,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=16.142379ms elapsed_secs=0.016142379
2025-11-08T16:05:46.214745Z DEBUG sqlx::query: summary="INSERT INTO account_move ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move (\n    tenant_id,\n    id,\n    name,\n    date,\n    journal_id,\n    currency_id,\n    move_type,\n    state,\n    partner_id,\n    commercial_partner_id,\n    partner_shipping_id,\n    partner_bank_id,\n    invoice_date,\n    invoice_date_due,\n    invoice_origin,\n    invoice_payment_term_id,\n    invoice_user_id,\n    invoice_incoterm_id,\n    fiscal_position_id,\n    narration,\n    amount_untaxed,\n    amount_tax,\n    amount_total,\n    amount_residual,\n    amount_untaxed_signed,\n    amount_tax_signed,\n    amount_total_signed,\n    amount_residual_signed,\n    created_by,\n    assignee_id,\n    shared_with\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    'out_invoice',\n    'draft',\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    $16,\n    $17,\n    $18,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    $19,\n    $20,\n    $21\n  )\n" rows_affected=1 rows_returned=0 elapsed=19.970081ms elapsed_secs=0.019970081
2025-11-08T16:05:46.228456Z DEBUG sqlx::query: summary="SELECT id FROM account_account ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_account\nWHERE\n  tenant_id = $1\n  AND account_type = 'income'\n  AND deprecated = FALSE\nORDER BY\n  code,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=11.904846ms elapsed_secs=0.011904846
2025-11-08T16:05:46.246013Z DEBUG sqlx::query: summary="INSERT INTO account_move_line ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move_line (\n    tenant_id,\n    id,\n    move_id,\n    currency_id,\n    product_id,\n    product_uom_id,\n    quantity,\n    price_unit,\n    discount,\n    name,\n    sequence,\n    display_type,\n    account_id,\n    price_subtotal,\n    price_total,\n    debit,\n    credit,\n    balance,\n    amount_currency,\n    exclude_from_invoice_tab\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    0,\n    0,\n    0,\n    0,\n    false\n  )\n" rows_affected=1 rows_returned=0 elapsed=13.707811ms elapsed_secs=0.013707811
2025-11-08T16:05:46.256714Z DEBUG sqlx::query: summary="SELECT COALESCE(SUM(price_subtotal), 0)::numeric as ‚Ä¶" db.statement="\n\nSELECT\n  COALESCE(SUM(price_subtotal), 0) :: numeric as amount_untaxed,\n  COALESCE(SUM(price_total - price_subtotal), 0) :: numeric as amount_tax,\n  COALESCE(SUM(price_total), 0) :: numeric as amount_total\nFROM\n  account_move_line\nWHERE\n  tenant_id = $1\n  AND move_id = $2\n  AND (\n    display_type IS NULL\n    OR display_type NOT IN ('line_section', 'line_subsection', 'line_note')\n  )\n" rows_affected=0 rows_returned=1 elapsed=7.74872ms elapsed_secs=0.00774872
2025-11-08T16:05:46.266146Z DEBUG sqlx::query: summary="UPDATE account_move SET amount_untaxed ‚Ä¶" db.statement="\n\nUPDATE\n  account_move\nSET\n  amount_untaxed = $1,\n  amount_tax = $2,\n  amount_total = $3,\n  amount_residual = $3,\n  amount_untaxed_signed = $1,\n  amount_tax_signed = $2,\n  amount_total_signed = $3,\n  amount_residual_signed = $3,\n  updated_at = now()\nWHERE\n  tenant_id = $4\n  AND id = $5\n" rows_affected=1 rows_returned=0 elapsed=5.731332ms elapsed_secs=0.005731332
2025-11-08T16:05:46.363499Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:05:46.382487Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=10.499542ms elapsed_secs=0.010499542
2025-11-08T16:05:46.388467Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:05:46.418252Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=18.313246ms elapsed_secs=0.018313246
2025-11-08T16:06:28.201442Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:06:28.202794Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:06:31.389073Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:06:31.390336Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:06:35.506332Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:35.534710Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=20.19296ms elapsed_secs=0.02019296
2025-11-08T16:06:35.536912Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:35.552464Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=7.637058ms elapsed_secs=0.007637058
2025-11-08T16:06:37.578617Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:37.630752Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=48.000423ms elapsed_secs=0.048000423
2025-11-08T16:06:37.633098Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:37.642331Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=5.004489ms elapsed_secs=0.005004489
2025-11-08T16:06:38.773482Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list?is_company=true&limit=200
2025-11-08T16:06:38.794429Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=3 rows_returned=3 elapsed=15.651076ms elapsed_secs=0.015651076
2025-11-08T16:06:38.796406Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list?is_company=true&limit=200
2025-11-08T16:06:38.800034Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /c0777777-7777-7777-7777-777777777777
2025-11-08T16:06:38.812880Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=3 rows_returned=3 elapsed=11.519559ms elapsed_secs=0.011519559
2025-11-08T16:06:38.824966Z DEBUG sqlx::query: summary="SELECT id, is_company, parent_id, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  is_company,\n  parent_id,\n  name,\n  display_name,\n  email,\n  phone,\n  mobile,\n  website,\n  street,\n  street2,\n  city,\n  state,\n  zip,\n  country_code,\n  national_id AS \"national_id?: String\",  -- üëà TH√äM\n  notes,\n  NULLIF(tags_cached, '') AS \"tags_cached?: String\",\n  created_at,\n  updated_at\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND id = $2\n" rows_affected=0 rows_returned=1 elapsed=19.834573ms elapsed_secs=0.019834573
2025-11-08T16:06:38.827383Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /c0777777-7777-7777-7777-777777777777
2025-11-08T16:06:38.839731Z DEBUG sqlx::query: summary="SELECT id, is_company, parent_id, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  is_company,\n  parent_id,\n  name,\n  display_name,\n  email,\n  phone,\n  mobile,\n  website,\n  street,\n  street2,\n  city,\n  state,\n  zip,\n  country_code,\n  national_id AS \"national_id?: String\",  -- üëà TH√äM\n  notes,\n  NULLIF(tags_cached, '') AS \"tags_cached?: String\",\n  created_at,\n  updated_at\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND id = $2\n" rows_affected=0 rows_returned=1 elapsed=6.088812ms elapsed_secs=0.006088812
2025-11-08T16:06:45.791719Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:45.907074Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=111.14582ms elapsed_secs=0.11114582
2025-11-08T16:06:45.909068Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:45.921730Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=8.924814ms elapsed_secs=0.008924814
2025-11-08T16:06:48.226262Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:48.251936Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=18.54648ms elapsed_secs=0.01854648
2025-11-08T16:06:48.254684Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:06:48.268324Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=6.282969ms elapsed_secs=0.006282969
2025-11-08T16:06:57.998528Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:06:58.000051Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:07:07.215661Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:07:07.217596Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:07:11.107926Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:11.166474Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=48.604761ms elapsed_secs=0.048604761
2025-11-08T16:07:11.169228Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:11.187969Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=10.240759ms elapsed_secs=0.010240759
2025-11-08T16:07:31.320640Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:31.341131Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=16.010045ms elapsed_secs=0.016010045
2025-11-08T16:07:31.343044Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:31.354247Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=5.480541ms elapsed_secs=0.005480541
2025-11-08T16:07:39.491318Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:39.661074Z DEBUG sqlx::query: summary="SELECT id, tenant_id, contact_id, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  tenant_id,\n  contact_id,\n  contract_number,\n  interest_rate,\n  term_months,\n  date_start,\n  date_end,\n  storage_fee_rate,\n  storage_fee,\n  current_principal,\n  current_interest,\n  accumulated_interest,\n  total_paid_interest,\n  total_settlement_amount,\n  state,\n  created_at,\n  updated_at,\n  created_by,\n  assignee_id,\n  shared_with,\n  0 :: int8 AS \"total_paid_principal!\",\n  0 :: int8 AS \"payoff_due!\"\nFROM\n  loan_contract\nWHERE\n  tenant_id = $1\nORDER BY\n  contract_number DESC\n" rows_affected=10 rows_returned=10 elapsed=165.61993ms elapsed_secs=0.16561993
2025-11-08T16:07:39.662620Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:39.772438Z DEBUG sqlx::query: summary="SELECT id, tenant_id, contact_id, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  tenant_id,\n  contact_id,\n  contract_number,\n  interest_rate,\n  term_months,\n  date_start,\n  date_end,\n  storage_fee_rate,\n  storage_fee,\n  current_principal,\n  current_interest,\n  accumulated_interest,\n  total_paid_interest,\n  total_settlement_amount,\n  state,\n  created_at,\n  updated_at,\n  created_by,\n  assignee_id,\n  shared_with,\n  0 :: int8 AS \"total_paid_principal!\",\n  0 :: int8 AS \"payoff_due!\"\nFROM\n  loan_contract\nWHERE\n  tenant_id = $1\nORDER BY\n  contract_number DESC\n" rows_affected=10 rows_returned=10 elapsed=106.27873ms elapsed_secs=0.10627873
2025-11-08T16:07:58.631525Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:58.661850Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=22.758415ms elapsed_secs=0.022758415
2025-11-08T16:07:58.663812Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:07:58.680601Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=2 rows_returned=2 elapsed=8.97764ms elapsed_secs=0.00897764
2025-11-08T16:08:06.266818Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:08:06.307637Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=35.258995ms elapsed_secs=0.035258995
2025-11-08T16:08:06.309440Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:08:06.318779Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=5.899031ms elapsed_secs=0.005899031
2025-11-08T16:08:33.384170Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:08:33.423027Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND type = 'sale'\n  AND active = TRUE\nORDER BY\n  sequence,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=36.665222ms elapsed_secs=0.036665222
2025-11-08T16:08:33.453464Z DEBUG sqlx::query: summary="INSERT INTO account_move ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move (\n    tenant_id,\n    id,\n    name,\n    date,\n    journal_id,\n    currency_id,\n    move_type,\n    state,\n    partner_id,\n    commercial_partner_id,\n    partner_shipping_id,\n    partner_bank_id,\n    invoice_date,\n    invoice_date_due,\n    invoice_origin,\n    invoice_payment_term_id,\n    invoice_user_id,\n    invoice_incoterm_id,\n    fiscal_position_id,\n    narration,\n    amount_untaxed,\n    amount_tax,\n    amount_total,\n    amount_residual,\n    amount_untaxed_signed,\n    amount_tax_signed,\n    amount_total_signed,\n    amount_residual_signed,\n    created_by,\n    assignee_id,\n    shared_with\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    'out_invoice',\n    'draft',\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    $16,\n    $17,\n    $18,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    $19,\n    $20,\n    $21\n  )\n" rows_affected=1 rows_returned=0 elapsed=23.239719ms elapsed_secs=0.023239719
2025-11-08T16:08:33.466254Z DEBUG sqlx::query: summary="SELECT id FROM account_account ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_account\nWHERE\n  tenant_id = $1\n  AND account_type = 'income'\n  AND deprecated = FALSE\nORDER BY\n  code,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=10.029119ms elapsed_secs=0.010029119
2025-11-08T16:08:33.488643Z DEBUG sqlx::query: summary="INSERT INTO account_move_line ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move_line (\n    tenant_id,\n    id,\n    move_id,\n    currency_id,\n    product_id,\n    product_uom_id,\n    quantity,\n    price_unit,\n    discount,\n    name,\n    sequence,\n    display_type,\n    account_id,\n    price_subtotal,\n    price_total,\n    debit,\n    credit,\n    balance,\n    amount_currency,\n    exclude_from_invoice_tab\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    0,\n    0,\n    0,\n    0,\n    false\n  )\n" rows_affected=1 rows_returned=0 elapsed=17.91706ms elapsed_secs=0.01791706
2025-11-08T16:08:33.496166Z DEBUG sqlx::query: summary="SELECT COALESCE(SUM(price_subtotal), 0)::numeric as ‚Ä¶" db.statement="\n\nSELECT\n  COALESCE(SUM(price_subtotal), 0) :: numeric as amount_untaxed,\n  COALESCE(SUM(price_total - price_subtotal), 0) :: numeric as amount_tax,\n  COALESCE(SUM(price_total), 0) :: numeric as amount_total\nFROM\n  account_move_line\nWHERE\n  tenant_id = $1\n  AND move_id = $2\n  AND (\n    display_type IS NULL\n    OR display_type NOT IN ('line_section', 'line_subsection', 'line_note')\n  )\n" rows_affected=0 rows_returned=1 elapsed=4.376959ms elapsed_secs=0.004376959
2025-11-08T16:08:33.510268Z DEBUG sqlx::query: summary="UPDATE account_move SET amount_untaxed ‚Ä¶" db.statement="\n\nUPDATE\n  account_move\nSET\n  amount_untaxed = $1,\n  amount_tax = $2,\n  amount_total = $3,\n  amount_residual = $3,\n  amount_untaxed_signed = $1,\n  amount_tax_signed = $2,\n  amount_total_signed = $3,\n  amount_residual_signed = $3,\n  updated_at = now()\nWHERE\n  tenant_id = $4\n  AND id = $5\n" rows_affected=1 rows_returned=0 elapsed=10.386636ms elapsed_secs=0.010386636
2025-11-08T16:08:33.603678Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:08:33.627817Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=3 rows_returned=3 elapsed=16.566169ms elapsed_secs=0.016566169
2025-11-08T16:08:33.629618Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:08:33.642088Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=3 rows_returned=3 elapsed=5.177649ms elapsed_secs=0.005177649
2025-11-08T16:17:01.743614Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list?is_company=true&limit=200
2025-11-08T16:17:01.788784Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=3 rows_returned=3 elapsed=39.34719ms elapsed_secs=0.03934719
2025-11-08T16:17:01.790525Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list?is_company=true&limit=200
2025-11-08T16:17:01.802310Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=3 rows_returned=3 elapsed=8.452757ms elapsed_secs=0.008452757
2025-11-08T16:17:11.180980Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:17:11.195149Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=8.775547ms elapsed_secs=0.008775547
2025-11-08T16:17:11.202577Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:17:11.213347Z DEBUG sqlx::query: summary="SELECT id, COALESCE(NULLIF(name,''), display_name, ‚Ä¶" db.statement="\n\nSELECT\n  id,\n  COALESCE(\n    NULLIF(name, ''),\n    display_name,\n    email,\n    phone,\n    '(kh√¥ng t√™n)'\n  ) AS \"name!: String\",\n  display_name,\n  email,\n  phone,\n  is_company,\n  NULLIF(tags_cached, '') AS \"tags?: String\",\n  state,\n  created_at,\n  updated_at,\n  national_id AS \"national_id?: String\" -- üëà TH√äM\nFROM\n  contact\nWHERE\n  tenant_id = $1\n  AND (\n    $2 :: bool IS NULL\n    OR is_company = $2\n  )\nORDER BY\n  created_at DESC\nLIMIT\n  $3 OFFSET $4\n" rows_affected=7 rows_returned=7 elapsed=6.66177ms elapsed_secs=0.00666177
2025-11-08T16:18:07.897031Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:18:07.927485Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND type = 'sale'\n  AND active = TRUE\nORDER BY\n  sequence,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=23.703129ms elapsed_secs=0.023703129
2025-11-08T16:18:07.970250Z DEBUG sqlx::query: summary="INSERT INTO account_move ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move (\n    tenant_id,\n    id,\n    name,\n    date,\n    journal_id,\n    currency_id,\n    move_type,\n    state,\n    partner_id,\n    commercial_partner_id,\n    partner_shipping_id,\n    partner_bank_id,\n    invoice_date,\n    invoice_date_due,\n    invoice_origin,\n    invoice_payment_term_id,\n    invoice_user_id,\n    invoice_incoterm_id,\n    fiscal_position_id,\n    narration,\n    amount_untaxed,\n    amount_tax,\n    amount_total,\n    amount_residual,\n    amount_untaxed_signed,\n    amount_tax_signed,\n    amount_total_signed,\n    amount_residual_signed,\n    created_by,\n    assignee_id,\n    shared_with\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    'out_invoice',\n    'draft',\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    $16,\n    $17,\n    $18,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    $19,\n    $20,\n    $21\n  )\n" rows_affected=1 rows_returned=0 elapsed=36.060176ms elapsed_secs=0.036060176
2025-11-08T16:18:07.985960Z DEBUG sqlx::query: summary="SELECT id FROM account_account ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_account\nWHERE\n  tenant_id = $1\n  AND account_type = 'income'\n  AND deprecated = FALSE\nORDER BY\n  code,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=13.86491ms elapsed_secs=0.01386491
2025-11-08T16:18:08.015524Z DEBUG sqlx::query: summary="INSERT INTO account_move_line ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move_line (\n    tenant_id,\n    id,\n    move_id,\n    currency_id,\n    product_id,\n    product_uom_id,\n    quantity,\n    price_unit,\n    discount,\n    name,\n    sequence,\n    display_type,\n    account_id,\n    price_subtotal,\n    price_total,\n    debit,\n    credit,\n    balance,\n    amount_currency,\n    exclude_from_invoice_tab\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    0,\n    0,\n    0,\n    0,\n    false\n  )\n" rows_affected=1 rows_returned=0 elapsed=24.807521ms elapsed_secs=0.024807521
2025-11-08T16:18:08.028395Z DEBUG sqlx::query: summary="SELECT COALESCE(SUM(price_subtotal), 0)::numeric as ‚Ä¶" db.statement="\n\nSELECT\n  COALESCE(SUM(price_subtotal), 0) :: numeric as amount_untaxed,\n  COALESCE(SUM(price_total - price_subtotal), 0) :: numeric as amount_tax,\n  COALESCE(SUM(price_total), 0) :: numeric as amount_total\nFROM\n  account_move_line\nWHERE\n  tenant_id = $1\n  AND move_id = $2\n  AND (\n    display_type IS NULL\n    OR display_type NOT IN ('line_section', 'line_subsection', 'line_note')\n  )\n" rows_affected=0 rows_returned=1 elapsed=9.682679ms elapsed_secs=0.009682679
2025-11-08T16:18:08.040903Z DEBUG sqlx::query: summary="UPDATE account_move SET amount_untaxed ‚Ä¶" db.statement="\n\nUPDATE\n  account_move\nSET\n  amount_untaxed = $1,\n  amount_tax = $2,\n  amount_total = $3,\n  amount_residual = $3,\n  amount_untaxed_signed = $1,\n  amount_tax_signed = $2,\n  amount_total_signed = $3,\n  amount_residual_signed = $3,\n  updated_at = now()\nWHERE\n  tenant_id = $4\n  AND id = $5\n" rows_affected=1 rows_returned=0 elapsed=9.569915ms elapsed_secs=0.009569915
2025-11-08T16:18:08.141202Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:18:08.156123Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=6.783624ms elapsed_secs=0.006783624
2025-11-08T16:18:08.160419Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:18:08.175928Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=7.225682ms elapsed_secs=0.007225682
2025-11-08T16:18:18.418918Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /modules
2025-11-08T16:18:18.713999Z DEBUG sqlx::query: summary="SELECT am.module_name, am.display_name, am.description, ‚Ä¶" db.statement="\n\nSELECT\n  am.module_name,\n  am.display_name,\n  am.description,\n  (tm.module_name IS NOT NULL) AS \"enabled!\",\n  (em.module_name IS NOT NULL) AS \"can_enable!\"\nFROM\n  available_module am\n  LEFT JOIN tenant t ON t.tenant_id = $1\n  LEFT JOIN tenant_enterprise_module em ON am.module_name = em.module_name\n  AND em.enterprise_id = t.enterprise_id\n  LEFT JOIN tenant_module tm ON am.module_name = tm.module_name\n  AND tm.tenant_id = $1\n" rows_affected=7 rows_returned=7 elapsed=282.000423ms elapsed_secs=0.282000423
2025-11-08T16:18:18.715664Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /modules
2025-11-08T16:18:18.910449Z DEBUG sqlx::query: summary="SELECT am.module_name, am.display_name, am.description, ‚Ä¶" db.statement="\n\nSELECT\n  am.module_name,\n  am.display_name,\n  am.description,\n  (tm.module_name IS NOT NULL) AS \"enabled!\",\n  (em.module_name IS NOT NULL) AS \"can_enable!\"\nFROM\n  available_module am\n  LEFT JOIN tenant t ON t.tenant_id = $1\n  LEFT JOIN tenant_enterprise_module em ON am.module_name = em.module_name\n  AND em.enterprise_id = t.enterprise_id\n  LEFT JOIN tenant_module tm ON am.module_name = tm.module_name\n  AND tm.tenant_id = $1\n" rows_affected=7 rows_returned=7 elapsed=171.55271ms elapsed_secs=0.17155271
2025-11-08T16:18:20.092625Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /scan
2025-11-08T16:18:20.104448Z DEBUG sqlx::query: summary="INSERT INTO available_module (module_name, ‚Ä¶" db.statement="\n\nINSERT INTO\n  available_module (module_name, display_name, description)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=6.729462ms elapsed_secs=0.006729462
2025-11-08T16:18:20.142278Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=36.873968ms elapsed_secs=0.036873968
2025-11-08T16:18:20.152953Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=9.640195ms elapsed_secs=0.009640195
2025-11-08T16:18:20.163234Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=9.377166ms elapsed_secs=0.009377166
2025-11-08T16:18:20.170836Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=6.420848ms elapsed_secs=0.006420848
2025-11-08T16:18:20.177300Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.459045ms elapsed_secs=0.005459045
2025-11-08T16:18:20.182643Z DEBUG sqlx::query: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=5.193322ms elapsed_secs=0.005193322
2025-11-08T16:18:20.189875Z DEBUG sqlx::query: summary="INSERT INTO available_module (module_name, ‚Ä¶" db.statement="\n\nINSERT INTO\n  available_module (module_name, display_name, description)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=2.908921ms elapsed_secs=0.002908921
2025-11-08T16:18:20.221033Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=30.324881ms elapsed_secs=0.030324881
2025-11-08T16:18:20.225240Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=3.38581ms elapsed_secs=0.00338581
2025-11-08T16:18:20.233830Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=7.577607ms elapsed_secs=0.007577607
2025-11-08T16:18:20.238981Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.259763ms elapsed_secs=0.004259763
2025-11-08T16:18:20.244949Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.025755ms elapsed_secs=0.005025755
2025-11-08T16:18:20.248604Z DEBUG sqlx::query: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=3.486439ms elapsed_secs=0.003486439
2025-11-08T16:18:20.258316Z DEBUG sqlx::query: summary="INSERT INTO available_module (module_name, ‚Ä¶" db.statement="\n\nINSERT INTO\n  available_module (module_name, display_name, description)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.20349ms elapsed_secs=0.00420349
2025-11-08T16:18:20.271038Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=11.838884ms elapsed_secs=0.011838884
2025-11-08T16:18:20.276459Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.513314ms elapsed_secs=0.004513314
2025-11-08T16:18:20.281903Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.370984ms elapsed_secs=0.004370984
2025-11-08T16:18:20.287204Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.224552ms elapsed_secs=0.004224552
2025-11-08T16:18:20.293886Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.631754ms elapsed_secs=0.005631754
2025-11-08T16:18:20.296744Z DEBUG sqlx::query: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=2.65972ms elapsed_secs=0.00265972
2025-11-08T16:18:20.304180Z DEBUG sqlx::query: summary="INSERT INTO available_module (module_name, ‚Ä¶" db.statement="\n\nINSERT INTO\n  available_module (module_name, display_name, description)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=2.035701ms elapsed_secs=0.002035701
2025-11-08T16:18:20.312118Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=7.093522ms elapsed_secs=0.007093522
2025-11-08T16:18:20.316691Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=3.748359ms elapsed_secs=0.003748359
2025-11-08T16:18:20.330513Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=12.93388ms elapsed_secs=0.01293388
2025-11-08T16:18:20.335956Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.449736ms elapsed_secs=0.004449736
2025-11-08T16:18:20.343200Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=6.280099ms elapsed_secs=0.006280099
2025-11-08T16:18:20.346532Z DEBUG sqlx::query: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=3.178204ms elapsed_secs=0.003178204
2025-11-08T16:18:20.353849Z DEBUG sqlx::query: summary="INSERT INTO available_module (module_name, ‚Ä¶" db.statement="\n\nINSERT INTO\n  available_module (module_name, display_name, description)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=3.92879ms elapsed_secs=0.00392879
2025-11-08T16:18:20.364530Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=9.384099ms elapsed_secs=0.009384099
2025-11-08T16:18:20.369497Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=3.684148ms elapsed_secs=0.003684148
2025-11-08T16:18:20.375831Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.29264ms elapsed_secs=0.00529264
2025-11-08T16:18:20.380566Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=3.867761ms elapsed_secs=0.003867761
2025-11-08T16:18:20.386248Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.714712ms elapsed_secs=0.004714712
2025-11-08T16:18:20.392640Z DEBUG sqlx::query: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=6.216038ms elapsed_secs=0.006216038
2025-11-08T16:18:20.398490Z DEBUG sqlx::query: summary="INSERT INTO available_module (module_name, ‚Ä¶" db.statement="\n\nINSERT INTO\n  available_module (module_name, display_name, description)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=3.719945ms elapsed_secs=0.003719945
2025-11-08T16:18:20.408086Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=8.749295ms elapsed_secs=0.008749295
2025-11-08T16:18:20.413042Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.034308ms elapsed_secs=0.004034308
2025-11-08T16:18:20.419547Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.632628ms elapsed_secs=0.005632628
2025-11-08T16:18:20.424977Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.609976ms elapsed_secs=0.004609976
2025-11-08T16:18:20.430552Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.680766ms elapsed_secs=0.004680766
2025-11-08T16:18:20.435085Z DEBUG sqlx::query: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=4.371443ms elapsed_secs=0.004371443
2025-11-08T16:18:20.440253Z DEBUG sqlx::query: summary="INSERT INTO available_module (module_name, ‚Ä¶" db.statement="\n\nINSERT INTO\n  available_module (module_name, display_name, description)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=2.535096ms elapsed_secs=0.002535096
2025-11-08T16:18:20.446164Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.040056ms elapsed_secs=0.005040056
2025-11-08T16:18:20.453556Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=6.370941ms elapsed_secs=0.006370941
2025-11-08T16:18:20.459877Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.200542ms elapsed_secs=0.005200542
2025-11-08T16:18:20.466277Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=5.447779ms elapsed_secs=0.005447779
2025-11-08T16:18:20.472103Z DEBUG sqlx::query: summary="INSERT INTO permissions (resource, ‚Ä¶" db.statement="\n\nINSERT INTO\n  permissions (resource, action, label)\nVALUES\n  ($1, $2, $3) ON CONFLICT DO NOTHING\n" rows_affected=0 rows_returned=0 elapsed=4.83895ms elapsed_secs=0.00483895
2025-11-08T16:18:20.478290Z DEBUG sqlx::query: summary="COMMIT" db.statement="" rows_affected=0 rows_returned=0 elapsed=6.04409ms elapsed_secs=0.00604409
2025-11-08T16:18:20.479316Z  INFO milan::infra::wasm_loader: ‚úÖ Loaded module: school
2025-11-08T16:18:20.479532Z  INFO milan::module::app::handler: ‚úÖ Reloaded external modules: 1
2025-11-08T16:18:20.483465Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /modules
2025-11-08T16:18:20.567331Z DEBUG sqlx::query: summary="SELECT am.module_name, am.display_name, am.description, ‚Ä¶" db.statement="\n\nSELECT\n  am.module_name,\n  am.display_name,\n  am.description,\n  (tm.module_name IS NOT NULL) AS \"enabled!\",\n  (em.module_name IS NOT NULL) AS \"can_enable!\"\nFROM\n  available_module am\n  LEFT JOIN tenant t ON t.tenant_id = $1\n  LEFT JOIN tenant_enterprise_module em ON am.module_name = em.module_name\n  AND em.enterprise_id = t.enterprise_id\n  LEFT JOIN tenant_module tm ON am.module_name = tm.module_name\n  AND tm.tenant_id = $1\n" rows_affected=7 rows_returned=7 elapsed=80.305225ms elapsed_secs=0.080305225
2025-11-08T16:19:22.297511Z  INFO milan::infra::wasm_loader: ‚úÖ Loaded module: school
2025-11-08T16:19:22.297644Z  INFO milan: ‚úÖ Loaded 1 modules ngo√†i binary t·ª´ "../modules"
2025-11-08T16:19:22.298667Z  INFO milan::api::external_modules: ‚úÖ Registered routes cho module: school
2025-11-08T16:19:38.786245Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:19:38.791946Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:19:39.122181Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /modules
2025-11-08T16:19:39.500110Z DEBUG sqlx::query: summary="SELECT am.module_name, am.display_name, am.description, ‚Ä¶" db.statement="\n\nSELECT\n  am.module_name,\n  am.display_name,\n  am.description,\n  (tm.module_name IS NOT NULL) AS \"enabled!\",\n  (em.module_name IS NOT NULL) AS \"can_enable!\"\nFROM\n  available_module am\n  LEFT JOIN tenant t ON t.tenant_id = $1\n  LEFT JOIN tenant_enterprise_module em ON am.module_name = em.module_name\n  AND em.enterprise_id = t.enterprise_id\n  LEFT JOIN tenant_module tm ON am.module_name = tm.module_name\n  AND tm.tenant_id = $1\n" rows_affected=7 rows_returned=7 elapsed=372.214768ms elapsed_secs=0.372214768
2025-11-08T16:19:39.501804Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /modules
2025-11-08T16:19:39.547454Z DEBUG sqlx::query: summary="SELECT am.module_name, am.display_name, am.description, ‚Ä¶" db.statement="\n\nSELECT\n  am.module_name,\n  am.display_name,\n  am.description,\n  (tm.module_name IS NOT NULL) AS \"enabled!\",\n  (em.module_name IS NOT NULL) AS \"can_enable!\"\nFROM\n  available_module am\n  LEFT JOIN tenant t ON t.tenant_id = $1\n  LEFT JOIN tenant_enterprise_module em ON am.module_name = em.module_name\n  AND em.enterprise_id = t.enterprise_id\n  LEFT JOIN tenant_module tm ON am.module_name = tm.module_name\n  AND tm.tenant_id = $1\n" rows_affected=7 rows_returned=7 elapsed=40.886683ms elapsed_secs=0.040886683
2025-11-08T16:19:48.672678Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:19:48.929165Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=249.33333ms elapsed_secs=0.24933333
2025-11-08T16:19:48.931138Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:19:48.941409Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=3.980031ms elapsed_secs=0.003980031
2025-11-08T16:19:54.012472Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:19:54.014870Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:19:54.331673Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:19:54.346514Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=7.434888ms elapsed_secs=0.007434888
2025-11-08T16:19:54.354137Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:19:54.368429Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=4.793533ms elapsed_secs=0.004793533
2025-11-08T16:20:15.947468Z  INFO milan::infra::wasm_loader: ‚úÖ Loaded module: school
2025-11-08T16:20:15.947611Z  INFO milan: ‚úÖ Loaded 1 modules ngo√†i binary t·ª´ "../modules"
2025-11-08T16:20:15.948640Z  INFO milan::api::external_modules: ‚úÖ Registered routes cho module: school
2025-11-08T16:20:23.033464Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:20:23.036685Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:20:23.353383Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:20:23.659271Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=296.438506ms elapsed_secs=0.296438506
2025-11-08T16:20:23.660952Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:20:23.929369Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=4 rows_returned=4 elapsed=235.275183ms elapsed_secs=0.235275183
2025-11-08T16:20:50.315872Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /create
2025-11-08T16:20:50.498549Z DEBUG sqlx::query: summary="SELECT id FROM account_journal ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_journal\nWHERE\n  tenant_id = $1\n  AND type = 'sale'\n  AND active = TRUE\nORDER BY\n  sequence,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=179.961242ms elapsed_secs=0.179961242
2025-11-08T16:20:50.650822Z DEBUG sqlx::query: summary="INSERT INTO account_move ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move (\n    tenant_id,\n    id,\n    name,\n    date,\n    journal_id,\n    currency_id,\n    move_type,\n    state,\n    partner_id,\n    commercial_partner_id,\n    partner_shipping_id,\n    partner_bank_id,\n    invoice_date,\n    invoice_date_due,\n    invoice_origin,\n    invoice_payment_term_id,\n    invoice_user_id,\n    invoice_incoterm_id,\n    fiscal_position_id,\n    narration,\n    amount_untaxed,\n    amount_tax,\n    amount_total,\n    amount_residual,\n    amount_untaxed_signed,\n    amount_tax_signed,\n    amount_total_signed,\n    amount_residual_signed,\n    created_by,\n    assignee_id,\n    shared_with\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    'out_invoice',\n    'draft',\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    $16,\n    $17,\n    $18,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    $19,\n    $20,\n    $21\n  )\n" rows_affected=1 rows_returned=0 elapsed=146.481346ms elapsed_secs=0.146481346
2025-11-08T16:20:50.724620Z DEBUG sqlx::query: summary="SELECT id FROM account_account ‚Ä¶" db.statement="\n\nSELECT\n  id\nFROM\n  account_account\nWHERE\n  tenant_id = $1\n  AND account_type = 'income'\n  AND deprecated = FALSE\nORDER BY\n  code,\n  created_at\nLIMIT\n  1\n" rows_affected=0 rows_returned=1 elapsed=68.010364ms elapsed_secs=0.068010364
2025-11-08T16:20:50.842771Z DEBUG sqlx::query: summary="INSERT INTO account_move_line ( ‚Ä¶" db.statement="\n\nINSERT INTO\n  account_move_line (\n    tenant_id,\n    id,\n    move_id,\n    currency_id,\n    product_id,\n    product_uom_id,\n    quantity,\n    price_unit,\n    discount,\n    name,\n    sequence,\n    display_type,\n    account_id,\n    price_subtotal,\n    price_total,\n    debit,\n    credit,\n    balance,\n    amount_currency,\n    exclude_from_invoice_tab\n  )\nVALUES\n  (\n    $1,\n    $2,\n    $3,\n    $4,\n    $5,\n    $6,\n    $7,\n    $8,\n    $9,\n    $10,\n    $11,\n    $12,\n    $13,\n    $14,\n    $15,\n    0,\n    0,\n    0,\n    0,\n    false\n  )\n" rows_affected=1 rows_returned=0 elapsed=113.785538ms elapsed_secs=0.113785538
2025-11-08T16:20:50.923145Z DEBUG sqlx::query: summary="SELECT COALESCE(SUM(price_subtotal), 0)::numeric as ‚Ä¶" db.statement="\n\nSELECT\n  COALESCE(SUM(price_subtotal), 0) :: numeric as amount_untaxed,\n  COALESCE(SUM(price_total - price_subtotal), 0) :: numeric as amount_tax,\n  COALESCE(SUM(price_total), 0) :: numeric as amount_total\nFROM\n  account_move_line\nWHERE\n  tenant_id = $1\n  AND move_id = $2\n  AND (\n    display_type IS NULL\n    OR display_type NOT IN ('line_section', 'line_subsection', 'line_note')\n  )\n" rows_affected=0 rows_returned=1 elapsed=77.433408ms elapsed_secs=0.077433408
2025-11-08T16:20:50.952821Z DEBUG sqlx::query: summary="UPDATE account_move SET amount_untaxed ‚Ä¶" db.statement="\n\nUPDATE\n  account_move\nSET\n  amount_untaxed = $1,\n  amount_tax = $2,\n  amount_total = $3,\n  amount_residual = $3,\n  amount_untaxed_signed = $1,\n  amount_tax_signed = $2,\n  amount_total_signed = $3,\n  amount_residual_signed = $3,\n  updated_at = now()\nWHERE\n  tenant_id = $4\n  AND id = $5\n" rows_affected=1 rows_returned=0 elapsed=26.918869ms elapsed_secs=0.026918869
2025-11-08T16:20:51.105417Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:20:51.116948Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=5 rows_returned=5 elapsed=4.427952ms elapsed_secs=0.004427952
2025-11-08T16:20:51.123321Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:20:51.135405Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=5 rows_returned=5 elapsed=4.439775ms elapsed_secs=0.004439775
2025-11-08T16:21:10.709294Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:21:10.711666Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /profile
2025-11-08T16:21:11.027084Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:21:11.051176Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=5 rows_returned=5 elapsed=16.775495ms elapsed_secs=0.016775495
2025-11-08T16:21:11.054268Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:21:11.065442Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=5 rows_returned=5 elapsed=4.39859ms elapsed_secs=0.00439859
2025-11-08T16:21:29.828113Z DEBUG sqlx::query: summary="SELECT tenant_id, shard_id FROM ‚Ä¶" db.statement="\n\nSELECT\n  tenant_id,\n  shard_id\nFROM\n  tenant\nWHERE\n  slug = $1\n" rows_affected=0 rows_returned=1 elapsed=53.33373ms elapsed_secs=0.05333373
2025-11-08T16:21:29.870151Z DEBUG sqlx::query: summary="SELECT tenant_id, user_id, email, ‚Ä¶" db.statement="\n\nSELECT\n  tenant_id,\n  user_id,\n  email,\n  name,\n  password_hash\nFROM\n  users\nWHERE\n  tenant_id = $1\n  AND email = $2\n" rows_affected=0 rows_returned=1 elapsed=29.087635ms elapsed_secs=0.029087635
2025-11-08T16:21:32.848356Z DEBUG sqlx::query: summary="SELECT t.tenant_id, t.enterprise_id, t.company_id, ‚Ä¶" db.statement="\n\nSELECT\n  t.tenant_id,\n  t.enterprise_id,\n  t.company_id,\n  t.name,\n  t.slug,\n  t.shard_id,\n  m.module_name as \"module_name?\"\nFROM\n  tenant t\n  LEFT JOIN tenant_module m ON m.tenant_id = t.tenant_id\nORDER BY\n  t.name\n" rows_affected=2 rows_returned=2 elapsed=177.648641ms elapsed_secs=0.177648641
2025-11-08T16:21:33.018761Z DEBUG sqlx::query: summary="SELECT t.tenant_id, t.enterprise_id, t.company_id, ‚Ä¶" db.statement="\n\nSELECT\n  t.tenant_id,\n  t.enterprise_id,\n  t.company_id,\n  t.name,\n  t.slug,\n  t.shard_id,\n  m.module_name as \"module_name?\"\nFROM\n  tenant t\n  LEFT JOIN tenant_module m ON m.tenant_id = t.tenant_id\nORDER BY\n  t.name\n" rows_affected=2 rows_returned=2 elapsed=163.53668ms elapsed_secs=0.16353668
2025-11-08T16:21:33.102138Z DEBUG sqlx::query: summary="SELECT module_name AS key, ‚Ä¶" db.statement="\n\nSELECT\n  module_name AS key,\n  display_name AS label\nFROM\n  available_module\nORDER BY\n  display_name\n" rows_affected=7 rows_returned=7 elapsed=211.133682ms elapsed_secs=0.211133682
2025-11-08T16:21:33.149426Z DEBUG sqlx::query: summary="SELECT module_name AS key, ‚Ä¶" db.statement="\n\nSELECT\n  module_name AS key,\n  display_name AS label\nFROM\n  available_module\nORDER BY\n  display_name\n" rows_affected=7 rows_returned=7 elapsed=44.524607ms elapsed_secs=0.044524607
2025-11-08T16:21:38.840829Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:21:38.872908Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=5 rows_returned=5 elapsed=23.971048ms elapsed_secs=0.023971048
2025-11-08T16:21:38.874699Z DEBUG milan::core::auth: üîê Middleware nh·∫≠n request: /list
2025-11-08T16:21:39.086320Z DEBUG sqlx::query: summary="SELECT am.id, am.tenant_id, am.name, ‚Ä¶" db.statement="\n\nSELECT\n  am.id,\n  am.tenant_id,\n  am.name,\n  am.ref as ref_field,\n  am.date,\n  am.journal_id,\n  am.currency_id,\n  am.move_type,\n  am.state,\n  am.partner_id,\n  am.invoice_partner_display_name as partner_display_name,\n  am.commercial_partner_id,\n  am.invoice_date,\n  am.invoice_date_due,\n  am.invoice_origin,\n  am.invoice_payment_term_id,\n  am.invoice_user_id,\n  am.fiscal_position_id,\n  am.payment_state,\n  am.payment_reference,\n  COALESCE(am.amount_untaxed, 0) :: numeric as amount_untaxed,\n  COALESCE(am.amount_tax, 0) :: numeric as amount_tax,\n  COALESCE(am.amount_total, 0) :: numeric as amount_total,\n  COALESCE(am.amount_residual, 0) :: numeric as amount_residual,\n  am.narration,\n  am.created_at,\n  am.updated_at,\n  am.created_by,\n  am.assignee_id\nFROM\n  account_move am\nWHERE\n  am.tenant_id = $1\nORDER BY\n  am.date DESC,\n  am.created_at DESC\nLIMIT\n  $2 OFFSET $3\n" rows_affected=5 rows_returned=5 elapsed=204.902651ms elapsed_secs=0.204902651
2025-11-08T17:22:51.819068Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
2025-11-08T17:22:51.867776Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
2025-11-08T17:22:56.866939Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
2025-11-08T17:22:56.883531Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
2025-11-08T17:23:04.383555Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
2025-11-08T17:23:39.470869Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
2025-11-08T17:42:30.424513Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:30.428322Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:32.170876Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:32.189535Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:33.874860Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:33.892731Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:36.312120Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:36.331634Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:44.912392Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:44.929842Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.838320Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.851123Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.851119Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.851125Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.851228Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.852964Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.857429Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.857429Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.867094Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.878948Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.878948Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.878948Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.878948Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.879263Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.883238Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:42:48.883238Z ERROR milan::core::auth: ‚ùå Middleware decode JWT l·ªói: Error(ExpiredSignature)
2025-11-08T17:49:26.501986Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
2025-11-08T17:49:26.517626Z ERROR milan::core::error: ‚ùå Internal error: DB error: error returned from database: relation "school_schools" does not exist
